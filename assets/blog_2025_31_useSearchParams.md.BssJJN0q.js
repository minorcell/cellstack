import{_ as a,c as i,o as n,a9 as t}from"./chunks/framework.DsVI9alt.js";const c=JSON.parse('{"title":"useSearchParams","description":"通过 useSearchParams 将 React 应用状态提升到 URL 查询参数，支持分享、持久化与浏览器历史控制，并示例防抖与 replace 更新的最佳实践。","frontmatter":{"title":"useSearchParams","description":"通过 useSearchParams 将 React 应用状态提升到 URL 查询参数，支持分享、持久化与浏览器历史控制，并示例防抖与 replace 更新的最佳实践。","author":"mcell","tags":["React","React Router","前端路由","SPA","useSearchParams","URL查询参数","状态管理","可分享链接","防抖","Hook"],"keywords":["React Router useSearchParams","URL查询参数状态","React路由持久化","浏览器历史替换","分享链接搜索状态","React防抖搜索","SPA状态同步","Hook管理URL","Query Params管理","React前端路由"],"head":[["link",{"rel":"canonical","href":"https://stack.mcell.topblog/2025/31_useSearchParams"}],["meta",{"property":"og:url","content":"https://stack.mcell.topblog/2025/31_useSearchParams"}]]},"headers":[],"relativePath":"blog/2025/31_useSearchParams.md","filePath":"blog/2025/31_useSearchParams.md","lastUpdated":1764698488000}'),h={name:"blog/2025/31_useSearchParams.md"};function l(e,s,p,k,r,d){return n(),i("div",null,s[0]||(s[0]=[t(`<p><img src="https://stack-mcell.tos-cn-shanghai.volces.com/073.png" alt="073" loading="lazy"></p><h1 id="usesearchparams" tabindex="-1">useSearchParams <a class="header-anchor" href="#usesearchparams" aria-label="Permalink to &quot;useSearchParams&quot;">​</a></h1><p>在开发 React 应用时，我们经常遇到一种场景：用户在搜索框输入关键词，筛选出一个列表，然后希望把这个结果分享给同事。</p><p>如果我们将筛选条件仅仅保存在组件的 <code>useState</code> 中，一旦刷新页面或复制链接，这些状态就会丢失，用户看到的只能是初始页面。</p><p>为了解决这个问题，我们需要将状态“提升”到 URL 的查询参数（Query Params）中。在 React Router v6 中，<code>useSearchParams</code> 这个 Hook 就是专门用来处理这个问题的。</p><p>本文将介绍如何使用它来实现 URL 与应用状态的同步。</p><h2 id="为什么要同步状态到-url" tabindex="-1">为什么要同步状态到 URL <a class="header-anchor" href="#为什么要同步状态到-url" aria-label="Permalink to &quot;为什么要同步状态到 URL&quot;">​</a></h2><p>在单页应用（SPA）中，URL 不仅仅是页面的地址，它还应该承载页面的<strong>状态</strong>。</p><p>将查询参数（如 <code>?q=react&amp;page=1</code>）绑定到 URL 有以下几个显而易见的好处：</p><ol><li><strong>可分享性</strong>：用户直接复制 URL 发送给他人，对方打开后看到的内容与发送者完全一致。</li><li><strong>持久性</strong>：刷新页面后，搜索条件和页码不会丢失。</li><li><strong>浏览器历史</strong>：用户可以使用浏览器的“后退”按钮回到上一次的搜索结果。</li></ol><h2 id="基本用法" tabindex="-1">基本用法 <a class="header-anchor" href="#基本用法" aria-label="Permalink to &quot;基本用法&quot;">​</a></h2><p><code>useSearchParams</code> 的用法与 React 原生的 <code>useState</code> 非常相似。它返回一个数组，包含两个元素：当前的查询参数对象和一个更新查询参数的函数。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useSearchParams } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;react-router-dom&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">searchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><ul><li><strong><code>searchParams</code></strong>：这是一个 <code>URLSearchParams</code> 对象，用于读取当前的 URL 参数。</li><li><strong><code>setSearchParams</code></strong>：这是一个函数，用于设置新的 URL 参数，并触发组件重新渲染。</li></ul><h2 id="读取参数" tabindex="-1">读取参数 <a class="header-anchor" href="#读取参数" aria-label="Permalink to &quot;读取参数&quot;">​</a></h2><p>假设当前的 URL 是 <code>http://localhost:3000/search?q=javascript</code>。</p><p>要获取 <code>q</code> 参数的值，我们使用 standard URLSearchParams API 中的 <code>.get()</code> 方法。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> searchParams.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;q&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 返回 &quot;javascript&quot;</span></span></code></pre></div><p><strong>注意</strong>：<code>URLSearchParams</code> 获取到的值默认都是字符串。如果你在处理页码（如 <code>?page=1</code>），获取到的将是字符串 <code>&quot;1&quot;</code>，在使用前可能需要通过 <code>parseInt</code> 或 <code>Number</code> 进行转换。</p><h2 id="写入参数" tabindex="-1">写入参数 <a class="header-anchor" href="#写入参数" aria-label="Permalink to &quot;写入参数&quot;">​</a></h2><p>要更新 URL 上的参数，我们调用 <code>setSearchParams</code>。这会更新 URL 的查询字符串，并自动将新的记录添加到浏览器的历史堆栈中。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 将 URL 更新为 /search?q=react</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ q: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;react&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span></code></pre></div><p>如果你想保留现有的其他参数（例如在切换页码时保留搜索关键词），你需要手动合并对象，或者传入一个回调函数（取决于 React Router 的具体版本行为，通常直接传入新对象会替换旧对象，因此建议显式构建新对象）。</p><h2 id="构建一个可分享的搜索组件" tabindex="-1">构建一个可分享的搜索组件 <a class="header-anchor" href="#构建一个可分享的搜索组件" aria-label="Permalink to &quot;构建一个可分享的搜索组件&quot;">​</a></h2><p>下面我们通过一个完整的示例，来实现一个“输入即搜索”且状态同步到 URL 的功能。</p><h3 id="需求分析" tabindex="-1">需求分析 <a class="header-anchor" href="#需求分析" aria-label="Permalink to &quot;需求分析&quot;">​</a></h3><ul><li>有一个输入框，用于输入搜索关键词。</li><li>输入框的值（Value）应该受控于 URL 中的 <code>q</code> 参数。</li><li>当用户输入时，更新 URL 参数。</li><li>页面根据 URL 参数展示结果。</li></ul><h3 id="代码实现" tabindex="-1">代码实现 <a class="header-anchor" href="#代码实现" aria-label="Permalink to &quot;代码实现&quot;">​</a></h3><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;react&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useSearchParams } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;react-router-dom&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SearchPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 1. 初始化 hook</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">searchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2. 读取参数：获取 URL 中的 &#39;q&#39;，如果没有则默认为空字符串</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> searchParams.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;q&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 3. 事件处理：当 input 变化时，更新 URL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleInputChange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">event</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> event.target.value</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (value) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 设置参数，URL 会变为 ?q=输入值</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      setSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ q: value })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 如果清空了输入，最好也移除参数，保持 URL 干净</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      setSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> style</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ padding: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;20px&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }}&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;搜索示例&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 输入框绑定 */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">input</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{query}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        onChange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{handleInputChange}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        placeholder</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;请输入搜索内容...&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        style</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ padding: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8px&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, width: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;300px&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 模拟展示结果 */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> style</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ marginTop: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;20px&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }}&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          当前的搜索关键词是：&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">strong</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{query}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">strong</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> style</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ color: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;#666&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fontSize: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;14px&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }}&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          试着复制现在的浏览器地址栏 URL 分享给别人，他们将看到同样的关键词。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SearchPage</span></span></code></pre></div><h3 id="代码解析" tabindex="-1">代码解析 <a class="header-anchor" href="#代码解析" aria-label="Permalink to &quot;代码解析&quot;">​</a></h3><p>这个组件的核心逻辑在于：<strong>输入框的状态不再由 <code>useState</code> 管理，而是直接由 <code>searchParams</code> 驱动。</strong></p><ul><li><strong>读取阶段</strong>：组件渲染时，直接从 URL 读取 <code>q</code> 赋值给 <code>input</code> 的 <code>value</code>。这意味着，如果用户是通过带有参数的链接进来的（例如 <code>/search?q=hello</code>），输入框里会自动填充 &quot;hello&quot;。</li><li><strong>写入阶段</strong>：用户输入时，调用 <code>setSearchParams</code>。这会修改 URL，URL 变化导致组件重新渲染，输入框的值随之更新。这是一个完美的闭环。</li></ul><h2 id="进阶细节" tabindex="-1">进阶细节 <a class="header-anchor" href="#进阶细节" aria-label="Permalink to &quot;进阶细节&quot;">​</a></h2><p>在使用 <code>useSearchParams</code> 时，还有两个细节值得注意。</p><h3 id="防抖-debounce" tabindex="-1">防抖（Debounce） <a class="header-anchor" href="#防抖-debounce" aria-label="Permalink to &quot;防抖（Debounce）&quot;">​</a></h3><p>上面的例子中，用户每输入一个字母，URL 就会更新一次，浏览器的历史记录也会增加一条。这在实际体验中可能不仅对性能有影响，也会让用户的“后退”操作变得困难（需要按很多次后退才能回到上一个页面）。</p><p>通常，我们会配合“防抖”技术，在用户停止输入 300ms 或 500ms 后再更新 URL。或者，使用 <code>setSearchParams</code> 的 <code>replace</code> 选项：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ q: value }, { replace: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span></code></pre></div><p>设置 <code>replace: true</code> 会替换当前的历史记录项，而不是新增一条，这样用户点击“后退”时会直接回到进入搜索页之前的页面。</p><h3 id="处理复杂对象" tabindex="-1">处理复杂对象 <a class="header-anchor" href="#处理复杂对象" aria-label="Permalink to &quot;处理复杂对象&quot;">​</a></h3><p>URL 参数本质上是字符串。如果你需要存储复杂的筛选对象（例如多选标签、日期范围），通常需要自行序列化。</p><ul><li><strong>写入时</strong>：将数组或对象转换为字符串（如逗号分隔 <code>tags=vue,react</code>）。</li><li><strong>读取时</strong>：将字符串拆解回数组。</li></ul><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p><code>useSearchParams</code> 是 React Router 提供的一个非常实用的 Hook。它弥合了组件内部状态与浏览器 URL 之间的鸿沟。</p><p>通过将状态提升至 URL：</p><ol><li>我们简化了组件的状态管理。</li><li>我们免费获得了“路由级”的状态持久化。</li><li>用户的分享体验得到了显著提升。</li></ol><p>在开发列表页、搜索页或任何需要保留视图状态的页面时，请优先考虑使用它。</p><p>(完)</p>`,48)]))}const o=a(h,[["render",l]]);export{c as __pageData,o as default};
